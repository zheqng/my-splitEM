

Large K

 零均值的模拟数据，零均值的模型

##  split-EM算法  SMGPFL.m
- 时间 107min
- 每一类200条曲线

- 参数学习结果


| 类别 | $\sqrt{v}$ | $\sqrt{w}$ | $\sqrt{\sigma^2}$ |
| ---- | ---------- | ---------- | ----------------- |
| 1    | 0.4520     | 3.1502     | 0.0224            |
  |2|  5.6426 |   5.4451 |   0.6631|
| 3   | 3.1705 | 3.1611 | 0.0319  |     |
| --- | ------ | ------ | ------- | --- |
| 4   | 4.1424 | 3.3164 | -0.4446 |     |
  |5 | 1.0082 |   0.7048 |   0.0319|
  |6|  5.0290 |   6.6458  |  1.2894|
  |7|  3.3304  |  8.9293 |   0.2762|
| 8   | 0.5455 | 1.0024 | 0.0564 |
| --- | ------ | ------ | ------ |
  |9 | 0.4526 |   0.7174  |  0.0621|

真实的参数

| 第几类 | $\sqrt{v}$ | $\sqrt{w}$ | $\sqrt{\sigma^2}$ |
| ------ | ---------- | ---------- | ----------------- |
| 1      | 0.4472     | 1.0000     | 0.0500            |
| 2      | 1.0000     | 0.7071     | 0.0316            |
| 3      | 0.4472     | 3.1623     | 0.0224            |
| 4      | 0.6325     | 1          | 0.0632            |
| 5      | 0.4472     | 0.7071     | 0.0632            |
| 6      | 3.3166     | 8.9443     | 0.3162            |
| 7      | 5.6833     | 5.4772     | 0.6633            |
| 8      | 4.9497     | 6.8644     | 1.2649            |
| 9      | 4.1231     | 3.3166     | 0.4472            |
| 10     | 3.1623     | 3.1623     | 0.0316            |

-  分类结果

  <img src="classification.jpg" width=50%>
结果可以看到，第1类，第4类和第5类区分不开
第6类和第7类相互重叠度较高。
试图只取第1,4,5类进行曲线聚类

- BIC

<img src="BIC.jpg" width=50%>


两种终止算法
  1. 每一次分裂重复100次，如果接受概率均小于1e-5,则终止
  2. BIC开始变大，则终止

然而，当重复次数足够多接受概率都非常小时，说明继续分裂的可能性已经非常小了，因而也不太可能计算出这之后分裂出的新参数的BIC。实际上，实验结果验证了这一点，BIC一直在减小，我们无法验证这之后的BIC是否还在减小，但可以猜想，这之后的BIC会增大。

- 预测结果
每一类的RMSE

| 0.0570 | 0.0576 | 0.0360 | 0.0354 | 0.0528 | 0.0560 | 0.0725 | 0.0730 | 0.0692 | 0.0688 |     |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | --- |
总体RMSE 0.0578







- 迭代50次的结果
- 每一类数目增加
每一类数目的增加可以提高参数估计的精度。

- 　只取1,4,5类进行实验
  - 每一类是200条的结果
  - 每一类是400条的结果

  <img src="classification-3.jpg" width=50%>

参数估计结果
　　0.4414    0.7024    0.0640
   0.4424    1.0110    0.0503
   0.6435    0.9991    0.0632
真实参数
0.4472    1.0000    0.0500
0.6325 1 0.0632
0.4472 0.7071 0.0632

RMSE   0.0567    0.0719    0.0692
总体RMSE 0.0652

说明参数选择的不好。

## 固定K的实验 fixed.m
