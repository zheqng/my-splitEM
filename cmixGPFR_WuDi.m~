function [T,Y,MET,ma1]=cmixGPFR_WuDi(curve_num)
x=linspace(-4,4,101)
m_class=mnrnd(Curve_num,[1/3,1/3,1/3]);
MU(1,:)=.5*sin(.125*(x-4).^2)+3;;
MU(2,:)=MU2;
MU(3,:)=MU3;

for i=1:m_class(1)
    T(i,:)=x;
%     MU1=.5*sin(.125*(T{i}-4).^2)+3;
    D=dist(T(i,:)').^2;
    C=.4*exp(-.5*D)+.004*eye(n);
    Tau1=mvnrnd(zeros(1,n),C);
    Y(i,:)=MU(1,:)+Tau1';
end
for i=(m_class(1)+1):(m_class(1)+m_class(2))
    T(i,:)=x;
    MU2=-3*exp(-(T(i,:)-4).^2/8)/(2*pi)^.5+3.7;
    D=dist(T(i,:)').^2;
    C=.2*exp(-.25*D)+.004*eye(n);
    Tau2=mvnrnd(zeros(1,n),C);
%     MU(i,:)=MU2;
    Y(i,:)=MU2+Tau2';
end
for i=(m_class(1)+m_class(2)+1):Curve_num
    T(i,:)= x;
    MU3=-atan(T(i,:)/2-2)/2+3;
    D=dist(T(i,:)').^2;
    C=.1*exp(-.1*D)+.004*eye(n);
    Tau3=mvnrnd(zeros(1,n),C);
%     MET{i}=MU3;
    Y(i,:)=MU3+Tau3';
end
